<?xml version="1.0"?>
<launch>
  <!-- Полный запуск Hector SLAM с симуляцией -->
  
  <!-- Запускаем фейковую симуляцию -->
  <include file="$(find study_pkg)/launch/turtlebot3_sim_start_fake.launch">
    <arg name="rviz" value="false"/>
  </include>

  <!-- Ждем инициализации симуляции -->
  <param name="use_sim_time" value="true"/>
  <node pkg="rostest" type="rostest" name="wait_simulation" 
        args="--wait 3 --text" output="screen"/>
  
  <!-- Запускаем Hector SLAM -->
  <node pkg="hector_mapping" type="hector_mapping" name="hector_mapping" output="screen">
    <param name="map_frame" value="map" />
    <param name="base_frame" value="base_footprint" />
    <param name="odom_frame" value="base_footprint" />
    <param name="map_resolution" value="0.05" />
    <param name="map_size" value="1024" />
    <param name="laser_min_dist" value="0.1" />
    <param name="laser_max_dist" value="12.0" />
    <param name="update_factor_free" value="0.4" />
    <param name="update_factor_occupied" value="0.9" />
  </node>

  <!-- Запускаем RVIZ для визуализации -->
  <node pkg="rviz" type="rviz" name="rviz" 
        args="-d $(find study_pkg)/rviz/hector.rviz"/>
</launch>